(function(){var t,e=function(t,e){function o(){this.constructor=t}for(var n in e)r.call(e,n)&&(t[n]=e[n]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},r={}.hasOwnProperty;t=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.http_port=8080,r.prototype.base_path="contents/web/",r.prototype.http=require("http"),r.prototype.mime=require("mime"),r.prototype.sio=require("socket.io"),r.prototype.fs=require("fs"),r.prototype.start=function(t){return null==t&&(t=!1),this.ws_start(),this.http.createServer(function(t){return function(e,r){return t.http_server_action(e,r)}}(this)).listen(this.http_port)},r.prototype.http_server_action=function(t,e){var r,o,n,i,s,p,c,h;return h=t.url.replace(/\/{2,}/,"/"),s=this.get_params(h),h=h.replace(/\?.*$/,""),"/"===h[h.length-1]&&(h+="index.html"),p=""+this.base_path+h,n=this.fs.existsSync(p),n?(r=this.fs.readFileSync(p),c=this.mime.lookup(p),e.writeHead(200,{"Content-Type":c}),e.end(r)):(e.writeHead(404),e.end("404 - file not found")),"html"===h.slice(h.length-4,+(h.length-1)+1||9e9)?(i=t.connection.remoteAddress.replace(/.*[^\d](\d+\.\d+\.\d+\.\d+$)/,"$1"),o=(new Date).toLocaleTimeString(),console.log(o+" "+i+" "+h)):void 0},r.prototype.ws_start=function(){return this.websocket=this.sio(this.ws_port),this.websocket.on("connection",function(t){return function(e){return e.on("g",function(r){return t.ws_reload(e,r)})}}(this))},r.prototype.ws_reload=function(t,e){var r,o,n,i,s;for(s=[],n=0,i=e.length;i>n;n++)r=e[n],o=""+this.base_path+r,this.fs.existsSync(o)?s.push(this.fs.watch(o,function(){return function(){return t.emit("reload")}}(this))):s.push(void 0);return s},r}(this.CommonJsAroundProtocol),this.NodeJsApp=function(){function e(){}return e.prototype.http=require("http"),e.prototype.https=require("https"),e.prototype.fs=require("fs"),e.prototype.server=new t,e.prototype.downloader=function(t,e){var r,o,n;return r=this.fs.createWriteStream(e),o=t.match(/^https/)?this.https:this.http,n=o.get(t,function(){return function(t){return t.pipe(r)}}(this))},e.prototype.check_dir_tree=function(t,e){return null==e&&(e=void 0),e&&(this.check_dir_tree_callback=e),this.check_dir_tree_read_dir(t)},e.prototype.check_dir_tree_callback=function(){return 1},e.prototype.check_dir_tree_read_dir=function(t){var e,r,o,n,i,s;for(r=this.fs.readdirSync(t),s=[],n=0,i=r.length;i>n;n++)e=r[n],o=""+t+e,this.fs.lstatSync(o).isDirectory()?s.push(this.check_dir_tree_read_dir(""+t+e+"/")):s.push(this.check_dir_tree_callback(o,e));return s},e}()}).call(this);